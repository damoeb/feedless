<div class="calendar">
  <div class="calendar-row">
    <!--    <div-->
    <!--      class="ion-hide-md-down"-->
    <!--      style="font-size: 2rem; align-content: center"-->
    <!--    >-->
    <!--      <a [routerLink]="getDateUrl(dateWindow[0].date.subtract(3, 'days'))"-->
    <!--      >-->
    <!--        <ion-button-->
    <!--          size="expand"-->
    <!--          color="light"-->
    <!--          (click)="$event.preventDefault(); $event.stopImmediatePropagation(); moveCalendarWindow(-3)"-->
    <!--        >-->
    <!--          <app-icon name="arrow-back-outline" slot="icon-only"></app-icon>-->
    <!--        </ion-button>-->
    <!--      </a>-->
    <!--    </div>-->
    <div class="calendar-days">
      <!--      <ion-button>-->
      <!--        <app-icon name="calendar-number-outline" slot="icon-only"></app-icon>-->
      <!--      </ion-button>-->

      @for (d of dateWindow; track d.date.toISOString(); let i = $index) {
        <a
          [routerLink]="'/' + getDateUrl(d.date)"
          [attr.rel]="getSeoLinkAttributes(d.date)"
          [ngClass]="{ 'ion-hide-md-down': i > dateWindow.length - 4 }"
        >
          <div
            class="calendar-day"
            role="button"
            tabindex="0"
            (click)="
              $event.preventDefault(); $event.stopImmediatePropagation(); changeDate.emit(d.date)
            "
            (keydown.enter)="$event.preventDefault(); changeDate.emit(d.date)"
            (keydown.space)="$event.preventDefault(); changeDate.emit(d.date)"
            [ngClass]="{
              past: isPast(d.date),
              active: isSameDate(date(), d.date, ['day', 'month', 'year']),
            }"
          >
            <div>{{ getWeekday(d.date) }}</div>
            <h3 style="font-size: 1.5rem">{{ formatDate(d.date, 'D') }}</h3>
            @if (i === 0 || d.date.date() === 1) {
              <div class="nowrap">{{ formatDate(d.date, 'MMM YY') }}</div>
            }
          </div>
        </a>
      }
    </div>
    <div style="font-size: 2rem; align-content: center">
      @if (isValidOffset(4)) {
        <a [routerLink]="getDateUrl(dateWindow[0].date.add(4, 'days'))">
          <ion-button size="expand" color="light" (click)="shiftDateWindow(4, $event)">
            <app-icon
              aria-label="Weiter im Kalender"
              name="arrow-forward-outline"
              slot="icon-only"
            ></app-icon>
          </ion-button>
        </a>
      } @else {
        <ion-button
          size="expand"
          aria-label="Weiter im Kalender (Ende erreicht)"
          [disabled]="true"
          color="light"
        >
          <app-icon name="arrow-forward-outline" slot="icon-only"></app-icon>
        </ion-button>
      }
    </div>
  </div>
  @if (!isDateInCalendar(now)) {
    <div style="justify-self: center">
      <ion-button size="small" (click)="changeDate.emit(now)">Heute anzeigen</ion-button>
    </div>
  }
</div>
